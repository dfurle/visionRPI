<html>
<head>

  <!--<script type="text/javascript" src="http://code.jquery.com/jquery-1.10.1.min.js"></script>-->
  <script type="text/javascript" src="jquery.js"></script>
</head>

<body>

  <div class="slidecontainer">
    minR<input type="range" min="0" max="255" value="50" class="slider" id="minR"><output id="minRo">50</output><br>
    maxR<input type="range" min="0" max="255" value="255" class="slider" id="maxR"><output id="maxRo">255</output><br>
    minG<input type="range" min="0" max="255" value="50" class="slider" id="minG"><output id="minGo">50</output><br>
    maxG<input type="range" min="0" max="255" value="255" class="slider" id="maxG"><output id="maxGo">255</output><br>
    minB<input type="range" min="0" max="255" value="50" class="slider" id="minB"><output id="minBo">50</output><br>
    maxB<input type="range" min="0" max="255" value="255" class="slider" id="maxB"><output id="maxBo">255</output><br>
  </div>
  <div class="slidecontainer">
    d0<input type="range" min="-1" max="1" value="0" step=0.01 class="slider" id="d0"><output id="d0o">0</output><br>
    d1<input type="range" min="-1" max="1" value="0" step=0.01 class="slider" id="d1"><output id="d1o">0</output><br>
    d2<input type="range" min="-1" max="1" value="0" step=0.01 class="slider" id="d2"><output id="d2o">0</output><br>
    d3<input type="range" min="-1" max="1" value="0" step=0.01 class="slider" id="d3"><output id="d3o">0</output><br>
    d4<input type="range" min="-1" max="1" value="0" step=0.01 class="slider" id="d4"><output id="d4o">0</output><br>
  </div>

  <img src="video_stream1" width="49%">
  <img src="video_stream2" width="49%">

  <script type="text/javascript">
    $(document).ready(function() {

      $("#minR").on("input", onInput);
      $("#maxR").on("input", onInput);
      $("#minG").on("input", onInput);
      $("#maxG").on("input", onInput);
      $("#minB").on("input", onInput);
      $("#maxB").on("input", onInput);

      $("#d0").on("input", onInput);
      $("#d1").on("input", onInput);
      $("#d2").on("input", onInput);
      $("#d3").on("input", onInput);
      $("#d4").on("input", onInput);

      function onInput(e) {
        // TODO: simplify this mess
        // maybe also make max move with min and min with max if overlap so easier to notice?
        var minRval = $("#minR").val();
        var maxRval = $("#maxR").val();
        var minGval = $("#minG").val();
        var maxGval = $("#maxG").val();
        var minBval = $("#minB").val();
        var maxBval = $("#maxB").val();
        var d0val = $("#d0").val();
        var d1val = $("#d1").val();
        var d2val = $("#d2").val();
        var d3val = $("#d3").val();
        var d4val = $("#d4").val();
        $("#minRo").html(minRval);
        $("#maxRo").html(maxRval);
        $("#minGo").html(minGval);
        $("#maxGo").html(maxGval);
        $("#minBo").html(minBval);
        $("#maxBo").html(maxBval);
        $("#d0o").html(d0val);
        $("#d1o").html(d1val);
        $("#d2o").html(d2val);
        $("#d3o").html(d3val);
        $("#d4o").html(d4val);

        let data = ""
        data += minRval + ",";
        data += maxRval + ",";
        data += minGval + ",";
        data += maxGval + ",";
        data += minBval + ",";
        data += maxBval + ",";
        data += d0val + ",";
        data += d1val + ",";
        data += d2val + ",";
        data += d3val + ",";
        data += d4val;
        //console.log(data);


        $.ajax({
          type: 'PUT',
          url: 'data',
          // contentType: 'application/json',
          contentType: 'text/plain',
          data: JSON.stringify(data),
        }).fail(function (msg) {
          console.log('FAIL');
        })
      }


      $.ajax({
        type: 'GET',
        url: 'initialData',
      }).fail(function (msg) {
        console.log('FAIL');
      }).then(function (msg) {
        data = msg.split(',')
        console.log(data)

        $("#minR").val(data[0]);
        $("#maxR").val(data[1]);
        $("#minG").val(data[2]);
        $("#maxG").val(data[3]);
        $("#minB").val(data[4]);
        $("#maxB").val(data[5]);
        $("#d0").val(data[6]);
        $("#d1").val(data[7]);
        $("#d2").val(data[8]);
        $("#d3").val(data[9]);
        $("#d4").val(data[10]);

        $("#minRo").html(data[0]);
        $("#maxRo").html(data[1]);
        $("#minGo").html(data[2]);
        $("#maxGo").html(data[3]);
        $("#minBo").html(data[4]);
        $("#maxBo").html(data[5]);
        $("#d0o").html(data[6]);
        $("#d1o").html(data[7]);
        $("#d2o").html(data[8]);
        $("#d3o").html(data[9]);
        $("#d4o").html(data[10]);
      })
      


    })
  </script>	

</body>
</html>
